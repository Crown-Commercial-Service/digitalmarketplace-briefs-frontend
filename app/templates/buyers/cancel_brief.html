{% extends "_base_page.html" %}

{% import "toolkit/forms/macros/forms.html" as forms %}

{% block pageTitle %}
  {{ brief.title or brief.lotName }} – Digital Marketplace
{% endblock %}

{% block breadcrumb %}
  {{ govukBreadcrumbs({
    "items": [
        {
          "href": "/",
          "text": "Digital Marketplace"
      },
      {
          "href": url_for("buyers.buyer_dashboard"),
          "text": "Your account"
      },
      {
          "href": url_for("buyers.buyer_dos_requirements"),
          "text": "Your requirements"
      },
      {
        "href": url_for(
            ".view_brief_overview",
            framework_slug=brief['frameworkSlug'],
            lot_slug=brief['lotSlug'],
            brief_id=brief['id']),
        "text": brief['title']
      },
      {
          "text": form.cancel_reason.label.text.replace(brief["title"], "").replace("for ", "").replace(" ?", "?")
      }
    ]
  }) }}
{% endblock %}

{% block mainContent %}
  {% include 'toolkit/forms/validation.html' %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="single-question-page">
        <h1 class="govuk-heading-l">{{ form.cancel_reason.label.text }}</h1>
        <form method="POST" action="{{ url_for(request.endpoint, framework_slug=brief.frameworkSlug, lot_slug=brief.lotSlug, brief_id=brief.id) }}">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <p class="govuk-body">
              This information will be added to your requirements. Suppliers will receive a link to view the update.
          </p>
          <p class="govuk-body">
              You’ll still need to contact suppliers to give them feedback.
          </p>
          {%
            with
            name = "cancel_reason",
            question = form.cancel_reason.label.text,
            type = "radio",
            options = form.cancel_reason.toolkit_macro_options,
            value = form.cancel_reason.data,
            error = errors.get('cancel_reason', {}).get('message', None)
          %}
            {% include "toolkit/forms/selection-buttons.html" %}
          {% endwith %}

          {% block save_button %}
            {{ govukButton({
              "text": "Update requirements",
              "name": "submit",
            }) }}
          {% endblock %}
        </form>

        {%
          with
          url=previous_page_url,
          text="Previous page"
        %}
          {% include "toolkit/secondary-action-link.html" %}
        {% endwith %}
      </div>
    </div>
  </div>
{% endblock %}
